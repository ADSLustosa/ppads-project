{% extends 'base.html' %}
{% block title %}ğŸ‘¤ Perfil - Tiger Bank{% endblock %}

{% block header %}
<h1>ğŸ¯ Meu Perfil</h1>
<nav>
  {% if current_user.is_authenticated %}
  <a class="btn btn-secondary" href="{{ url_for('dashboard.index') }}">VOLTAR</a>
  <form action="{{ url_for('auth.logout') }}" method="post" style="display:inline">
    <button class="btn btn-outline-danger" type="submit">SAIR</button>
  </form>
  {% endif %}
</nav>
{% endblock %}

{% block content %}
<div class="card">
  <h2>ğŸ‘¤ Meu Perfil</h2><br>

  <!-- Ãrea do perfil -->
  <div class="user-profile-card">
    <div class="user-header">
      <div class="user-avatar">{{ current_user.name[0]|upper }}</div>
      <div class="user-info">
        <h3>{{ current_user.name }}</h3>
        <p>Conta {{ current_user.account.type }}</p>
      </div>
    </div>

    <div class="user-data-grid">
      <div class="user-data-item">
        <label>CPF</label>
        <div class="value">{{ current_user.cpf }}</div>
      </div>
      <div class="user-data-item">
        <label>E-mail</label>
        <div class="value">{{ current_user.email }}</div>
      </div>
      <div class="user-data-item">
        <label>Saldo Atual</label>
        <div class="value">R$ {{ '%.2f'|format(current_user.account.balance|float) }}</div>
      </div>
      <div class="user-data-item">
        <label>Membro desde</label>
        <div class="value">{{ current_user.created_at.strftime("%d/%m/%Y") }}</div>
      </div>
    </div>
  </div>
</div>

<!-- FormulÃ¡rio de atualizaÃ§Ã£o -->
<h3 style="margin: 30px 0 20px 0; text-align:center;">âœï¸ Editar InformaÃ§Ãµes</h3>
<form method="post" action="{{ url_for('profile.update') }}" class="card">
  <div class="form-group">
    <label>Nome</label>
    <input name="name" value="{{ current_user.name }}" required>
  </div>
  <div class="form-group">
    <label>E-mail</label>
    <input type="email" name="email" value="{{ current_user.email }}" required>
  </div>
  <div class="form-group">
    <label>Senha atual</label>
    <input type="password" name="senha_atual" required>
  </div>
  <button class="btn btn-success" type="submit">SALVAR</button>
</form>

<!-- FormulÃ¡rio de troca de senha -->
<h3 style="margin: 30px 0 20px 0; text-align:center;">ğŸ”’ Alterar Senha</h3>
<form method="post" action="{{ url_for('profile.change_password') }}" class="card">
  <div class="form-group">
    <label>Senha atual</label>
    <input type="password" name="atual" required>
  </div>
  <div class="form-group">
    <label>Nova senha</label>
    <input type="password" name="nova" minlength="8" required>
  </div>
  <div class="form-group">
    <label>Confirmar nova senha</label>
    <input type="password" name="conf" required>
  </div>
  <button class="btn btn-primary" type="submit">ALTERAR</button>
</form>
{% endblock %}
